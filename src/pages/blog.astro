---
import '../styles/pages/blog.scss'

import Layout from '../layouts/Layout.astro'

import request  from 'request'

var posts = []

request.post(
  {
    url: 'https://blogfeed.adarshrkumar.dev/getAllPosts'
  }, 
  function(err, res, body) {
    posts = body
    // if (
    //   (body.startsWith('[') && body.endsWith(']')) || 
    //   (body.startsWith('{') && body.endsWith('}'))
    // ) {
    //   body = JSON.parse(body)
    // }
    // if (typeof body === 'object') {
    //   posts = body
    // }
  }
)

---
<Layout title="Blog">
  <section class="posts">
    { posts }
    {
      posts.map((post) => {
        <div class="post">
          { post.image ? <img src={ post.image.src }/> : '' }
          <div class="info">
            <h3>{post.title}</h3>
            <p>{post.content}</p>
          </div>
        </div>
      })
    }
  </section>
</Layout>